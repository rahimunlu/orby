(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[730],{1726:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9767).A)("qr-code",[["rect",{width:"5",height:"5",x:"3",y:"3",rx:"1",key:"1tu5fj"}],["rect",{width:"5",height:"5",x:"16",y:"3",rx:"1",key:"1v8r4q"}],["rect",{width:"5",height:"5",x:"3",y:"16",rx:"1",key:"1x03jg"}],["path",{d:"M21 16h-3a2 2 0 0 0-2 2v3",key:"177gqh"}],["path",{d:"M21 21v.01",key:"ents32"}],["path",{d:"M12 7v3a2 2 0 0 1-2 2H7",key:"8crl2c"}],["path",{d:"M3 12h.01",key:"nlz23k"}],["path",{d:"M12 3h.01",key:"n36tog"}],["path",{d:"M12 16v.01",key:"133mhm"}],["path",{d:"M16 12h1",key:"1slzba"}],["path",{d:"M21 12v.01",key:"1lwtk9"}],["path",{d:"M12 21v-1",key:"1880an"}]])},2775:(e,t,a)=>{"use strict";a.d(t,{A:()=>s});let s=(0,a(9767).A)("external-link",[["path",{d:"M15 3h6v6",key:"1q9fwt"}],["path",{d:"M10 14 21 3",key:"gplh6r"}],["path",{d:"M18 13v6a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V8a2 2 0 0 1 2-2h6",key:"a6xqqp"}]])},6722:(e,t,a)=>{"use strict";a.r(t),a.d(t,{default:()=>f});var s=a(4540),l=a(9952),i=a(6879),n=a(9573);let r={get:()=>{let e=localStorage.getItem("orby_session");return e?JSON.parse(e):null}};var o=a(8869),c=a(2787),d=a(9767);let h=(0,d.A)("lock-open",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 9.9-1",key:"1mm8w8"}]]),p=(0,d.A)("lock",[["rect",{width:"18",height:"11",x:"3",y:"11",rx:"2",ry:"2",key:"1w4ew1"}],["path",{d:"M7 11V7a5 5 0 0 1 10 0v4",key:"fwvmzm"}]]);var x=a(6467);let u=(0,d.A)("arrow-up-right",[["path",{d:"M7 7h10v10",key:"1tivn9"}],["path",{d:"M7 17 17 7",key:"1vkiza"}]]);var m=a(2775),b=a(7966);function f(){let e=(0,i.useRouter)(),[t,a]=(0,l.useState)(null),[d,f]=(0,l.useState)(null),[v,g]=(0,l.useState)(!1),[y,w]=(0,l.useState)(!1),[k,j]=(0,l.useState)(!1),[N,T]=(0,l.useState)(!0),[A,S]=(0,l.useState)(10);(0,l.useEffect)(()=>{(()=>{if(!o.qK.hasWallet())return e.push("/login");T(!1)})()},[e]);let C=async()=>{g(!0);try{let e=r.get(),t=(null==e?void 0:e.userId)||"user123",s=(null==e?void 0:e.sessionToken)||"sessionToken",[l,i]=await Promise.all([n.F.getBalances(t,s),n.F.getFestival()]);a(l),f(i)}catch(e){console.error(e)}finally{g(!1)}};(0,l.useEffect)(()=>{N||C()},[N]);let I=async()=>{if(!y&&!(A<=0)){w(!0);try{let e=r.get(),t=await n.F.topUp({userId:(null==e?void 0:e.userId)||"user123",sessionToken:(null==e?void 0:e.sessionToken)||"sessionToken",amountUsdt:A});t.success?(await C(),z("Deposit successful! TX: ".concat(t.depositHash.slice(0,10),"..."))):z("Deposit failed. Please try again.")}catch(e){console.error("Topup failed",e),z("Deposit failed. Please try again.")}finally{w(!1)}}},M=async()=>{if(!k){if(d&&!d.redemptionOpen&&d.endTime>Date.now()/1e3)return void z("Redemption is not open yet.");j(!0);try{let e=r.get(),t=await n.F.cashOut((null==e?void 0:e.userId)||"user123",(null==e?void 0:e.sessionToken)||"sessionToken");t.success?(await C(),z("Cash out successful! Returned: $".concat((parseFloat(t.usdtReturned)/1e6).toFixed(2)," USDT"))):z("Cash out failed. Please try again.")}catch(e){console.error("Cashout failed",e),z("Cash out failed. Please try again.")}finally{j(!1)}}},z=e=>{let t=document.createElement("div");t.className="fixed top-6 left-1/2 transform -translate-x-1/2 bg-black/90 backdrop-blur-md text-white px-6 py-4 rounded-2xl border border-white/10 shadow-2xl z-50 font-bold animate-fade-in-down font-display tracking-tight flex items-center gap-3",t.innerHTML='<span class="text-orby">âœ“</span> '.concat(e),document.body.appendChild(t),setTimeout(()=>t.remove(),4e3)},E=t?(parseFloat(t.festivalTokens)/1e18).toLocaleString("en-US",{minimumFractionDigits:0,maximumFractionDigits:2}):"0",L=t?(parseFloat(t.usdt)/1e6).toFixed(2):"0.00",F=t?(parseFloat(t.escrowedUSDT)/1e6).toFixed(2):"0.00",O=(null==d?void 0:d.redemptionOpen)||d&&d.endTime<=Date.now()/1e3;return N?(0,s.jsx)("div",{className:"min-h-screen bg-orby flex items-center justify-center",children:(0,s.jsx)(c.A,{className:"animate-spin text-white",size:32})}):(0,s.jsx)(b.A,{bgClass:"bg-orby",children:(0,s.jsxs)("div",{className:"flex flex-col text-white px-6 pt-6 min-h-[calc(100vh-96px)]",children:[(0,s.jsxs)("div",{className:"flex justify-between items-center mb-4 animate-fade-in",children:[(0,s.jsx)("h1",{className:"text-3xl font-display font-black tracking-tighter lowercase italic",children:"orby"}),(0,s.jsxs)("div",{className:"flex items-center gap-2",children:[(0,s.jsxs)("div",{className:"flex items-center gap-1.5 px-3 py-1.5 rounded-full text-xs font-bold border ".concat(O?"bg-green-500/20 text-green-400 border-green-500/30":"bg-orange-500/20 text-orange-400 border-orange-500/30"),children:[O?(0,s.jsx)(h,{size:12}):(0,s.jsx)(p,{size:12}),O?"Open":"Closed"]}),(0,s.jsx)("button",{onClick:C,disabled:v,className:"bg-black/20 backdrop-blur-md text-white p-2 rounded-full border border-white/10 hover:bg-black/30 transition-colors",children:(0,s.jsx)(c.A,{size:16,className:v?"animate-spin":""})})]})]}),(0,s.jsx)("div",{className:"flex-1 flex flex-col justify-center items-center pb-4",children:(0,s.jsxs)("div",{className:"text-center transform -translate-y-8 animate-scale-in",children:[(0,s.jsxs)("div",{className:"relative inline-block",children:[(0,s.jsxs)("div",{className:"text-[80px] sm:text-[100px] leading-none font-display font-black tracking-tighter mb-2 drop-shadow-sm",children:["$",E]}),(0,s.jsx)("div",{className:"absolute top-1/2 left-1/2 -translate-x-1/2 -translate-y-1/2 w-full h-full bg-white blur-[100px] opacity-20 pointer-events-none rounded-full"})]}),(0,s.jsx)("div",{className:"flex flex-col gap-2 items-center opacity-90 font-medium text-lg font-sans animate-fade-in-up delay-100",children:v?(0,s.jsx)(c.A,{className:"animate-spin mb-2"}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsxs)("span",{className:"tracking-widest uppercase text-xs font-bold text-white/80 mb-1",children:[d?d.symbol:"TOKENS"," Available"]}),(0,s.jsxs)("span",{className:"text-xs bg-black/20 backdrop-blur-md px-4 py-1.5 rounded-full font-bold text-white/90 border border-white/10 shadow-sm",children:["USDT Balance: $",L]}),(0,s.jsxs)("span",{className:"text-xs bg-black/20 backdrop-blur-md px-4 py-1.5 rounded-full font-bold text-white/90 border border-white/10 shadow-sm flex items-center gap-1.5",children:[(0,s.jsx)(p,{size:10}),"Locked in Vault: $",F]})]})})]})}),(0,s.jsxs)("div",{className:"mb-4 animate-fade-in-up delay-150",children:[(0,s.jsx)("label",{className:"text-xs font-bold text-white/60 uppercase tracking-wider mb-2 block",children:"Deposit Amount (USDT)"}),(0,s.jsx)("div",{className:"flex gap-2",children:[10,25,50,100].map(e=>(0,s.jsxs)("button",{onClick:()=>S(e),className:"flex-1 py-2 rounded-xl font-bold text-sm transition-all ".concat(A===e?"bg-white text-black":"bg-black/20 text-white/80 border border-white/10 hover:bg-black/30"),children:["$",e]},e))})]}),(0,s.jsxs)("div",{className:"grid grid-cols-2 gap-4 mt-auto mb-4 w-full",children:[(0,s.jsxs)("button",{onClick:I,disabled:y||A<=0,className:"bg-black hover:bg-zinc-900 active:scale-95 transition-all duration-300 text-white rounded-[32px] p-6 h-40 flex flex-col justify-between relative overflow-hidden group shadow-lg animate-fade-in-up delay-200 border border-white/5 disabled:opacity-50 disabled:cursor-not-allowed",children:[(0,s.jsx)("div",{className:"absolute top-0 right-0 p-5 group-hover:rotate-90 transition-transform duration-300",children:(0,s.jsx)(x.A,{size:28,className:"text-orby"})}),(0,s.jsxs)("div",{className:"mt-auto relative z-10",children:[(0,s.jsxs)("span",{className:"text-xs text-white/60 block mb-1",children:["$",A," USDT"]}),(0,s.jsx)("span",{className:"text-2xl font-display font-bold tracking-tight block group-hover:translate-x-1 transition-transform",children:y?"ADDING...":"DEPOSIT"})]}),(0,s.jsx)("div",{className:"absolute inset-0 bg-gradient-to-tr from-white/10 to-transparent opacity-0 group-hover:opacity-100 transition-opacity duration-500"})]}),(0,s.jsxs)("button",{onClick:M,disabled:k||!t||0===parseFloat(t.festivalTokens),className:"backdrop-blur-md border hover:bg-white/20 active:scale-95 transition-all duration-300 text-white rounded-[32px] p-6 h-40 flex flex-col justify-between relative overflow-hidden group animate-fade-in-up delay-300 disabled:opacity-50 disabled:cursor-not-allowed ".concat(O?"bg-green-500/10 border-green-500/30":"bg-white/10 border-white/20"),children:[(0,s.jsx)("div",{className:"absolute top-0 right-0 p-5 group-hover:-translate-y-1 group-hover:translate-x-1 transition-transform duration-300",children:(0,s.jsx)(u,{size:28,strokeWidth:2.5,className:"text-white opacity-80"})}),(0,s.jsxs)("div",{className:"mt-auto relative z-10",children:[(0,s.jsxs)("span",{className:"text-xs text-white/60 block mb-1 flex items-center gap-1",children:[O?(0,s.jsx)(h,{size:10}):(0,s.jsx)(p,{size:10}),O?"Available":"Locked"]}),(0,s.jsx)("span",{className:"text-2xl font-display font-bold tracking-tight block group-hover:translate-x-1 transition-transform",children:k?"CASHING...":"CASH OUT"})]})]})]}),(null==d?void 0:d.vaultAddress)&&(0,s.jsx)("div",{className:"mb-4 animate-fade-in-up delay-400",children:(0,s.jsxs)("a",{href:"https://sepolia.etherscan.io/address/".concat(d.vaultAddress),target:"_blank",rel:"noopener noreferrer",className:"flex items-center justify-center gap-2 text-xs text-white/50 hover:text-white/80 transition-colors",children:[(0,s.jsx)(m.A,{size:12}),"View Vault on Etherscan"]})})]})})}},7966:(e,t,a)=>{"use strict";a.d(t,{A:()=>b});var s=a(4540),l=a(9952),i=a(2775),n=a(6879),r=a(1726),o=a(4422),c=a(9767);let d=(0,c.A)("activity",[["path",{d:"M22 12h-2.48a2 2 0 0 0-1.93 1.46l-2.35 8.36a.25.25 0 0 1-.48 0L9.24 2.18a.25.25 0 0 0-.48 0l-2.35 8.36A2 2 0 0 1 4.49 12H2",key:"169zse"}]]),h=(0,c.A)("menu",[["path",{d:"M4 5h16",key:"1tepv9"}],["path",{d:"M4 12h16",key:"1lakjw"}],["path",{d:"M4 19h16",key:"1djgab"}]]);var p=function(e){return e.WALLET="WALLET",e.ACTIVITY="ACTIVITY",e.MENU="MENU",e.QR="QR",e}({});let x=[{id:p.QR,icon:r.A,label:"QR",path:"/qr"},{id:p.WALLET,icon:o.A,label:"WALLET",path:"/wallet"},{id:p.ACTIVITY,icon:d,label:"ACTIVITY",path:"/activity"},{id:p.MENU,icon:h,label:"MENU",path:"/menu"}];function u(){let e=(0,n.useRouter)(),t=(0,n.usePathname)(),a="/wallet"===t||"/"===t?p.WALLET:"/activity"===t?p.ACTIVITY:"/menu"===t?p.MENU:"/qr"===t?p.QR:p.WALLET;return(0,s.jsx)("div",{className:"fixed bottom-6 left-0 w-full flex justify-center z-50 pointer-events-none",children:(0,s.jsx)("div",{className:"w-[92%] max-w-md pointer-events-auto animate-fade-in-up delay-400",children:(0,s.jsx)("div",{className:"flex items-center justify-between bg-zinc-950/90 backdrop-blur-xl border border-white/10 rounded-full px-2 py-2 shadow-2xl ring-1 ring-white/5",children:x.map(t=>{let l=a===t.id,i=t.icon;return(0,s.jsxs)("button",{onClick:()=>e.push(t.path),className:"flex items-center gap-2 px-5 py-3 rounded-full transition-all duration-300 ".concat(l?"bg-orby text-white shadow-[0_0_15px_rgba(40,80,255,0.5)] font-bold":"text-zinc-500 hover:text-white"),children:[(0,s.jsx)(i,{size:20,strokeWidth:l?2.5:2}),l&&(0,s.jsx)("span",{className:"text-xs tracking-wider font-sans",children:t.label})]},t.id)})})})})}var m=a(9573);function b(e){let{children:t,hideNav:a=!1,bgClass:n="bg-orby-dark",showVaultLink:r=!0}=e,[o,c]=(0,l.useState)(null);return(0,l.useEffect)(()=>{r&&m.F.getFestival().then(c).catch(console.error)},[r]),(0,s.jsxs)("div",{className:"relative min-h-screen w-full overflow-hidden flex flex-col text-white ".concat(n),children:[(0,s.jsx)("div",{className:"flex-1 overflow-y-auto pb-32 no-scrollbar",children:t}),r&&(null==o?void 0:o.vaultAddress)&&(0,s.jsx)("div",{className:"fixed bottom-24 left-0 w-full flex justify-center z-40 pointer-events-none",children:(0,s.jsxs)("a",{href:"".concat("https://sepolia.etherscan.io/address/").concat(o.vaultAddress),target:"_blank",rel:"noopener noreferrer",className:"pointer-events-auto flex items-center gap-1.5 px-3 py-1.5 bg-black/60 backdrop-blur-md rounded-full text-xs text-white/50 hover:text-white/80 border border-white/10 transition-colors",children:[(0,s.jsx)(i.A,{size:10}),"Vault: ",o.vaultAddress.slice(0,6),"...",o.vaultAddress.slice(-4)]})}),!a&&(0,s.jsx)(u,{})]})}},8869:(e,t,a)=>{"use strict";a.d(t,{qK:()=>i});var s=a(5653);a(4101).env.NEXT_PUBLIC_SEPOLIA_RPC_URL;let l="orby_seed",i={createWallet(){let e=s.we();return localStorage.setItem(l,e),e},hasWallet:()=>!!localStorage.getItem(l),getSeedPhrase:()=>localStorage.getItem(l),validateMnemonic:e=>s.JB(e),isInitialized(){return this.hasWallet()},clearWallet(){localStorage.removeItem(l)}}},9573:(e,t,a)=>{"use strict";a.d(t,{F:()=>l});let s=a(4101).env.NEXT_PUBLIC_API_URL||"",l={getFestival:async()=>{let e=await fetch("".concat(s,"/api/admin/festival"));return e.ok?e.json():null},createFestival:async e=>(await fetch("".concat(s,"/api/admin/create-festival"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json(),join:async e=>(await fetch("".concat(s,"/api/festival/join"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({nickname:e})})).json(),getBalances:async(e,t)=>(await fetch("".concat(s,"/api/festival/balances?userId=").concat(e,"&sessionToken=").concat(t))).json(),topUp:async e=>(await fetch("".concat(s,"/api/festival/topup"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)})).json(),cashOut:async(e,t)=>(await fetch("".concat(s,"/api/festival/cashout"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({userId:e,sessionToken:t})})).json()}},9856:(e,t,a)=>{Promise.resolve().then(a.bind(a,6722))}},e=>{e.O(0,[366,736,540,358],()=>e(e.s=9856)),_N_E=e.O()}]);